ext {
	snippetsDir = file('build/generated-snippets')
}


dependencies{
	runtimeOnly project(":demo-storage")
//	implementation project(":demo-storage") // runtimeOnly â†’ implementation ë³€ê²½
	implementation project(":demo-domain")
	implementation project(":demo-common")
	implementation project(":demo-external")
	implementation 'io.jsonwebtoken:jjwt-api:0.11.2'
	implementation 'io.jsonwebtoken:jjwt-impl:0.11.2'
	implementation 'io.jsonwebtoken:jjwt-jackson:0.11.2'
	implementation 'org.springframework.boot:spring-boot-starter-security'
	testImplementation 'org.springframework.security:spring-security-test'
	testImplementation project(':api-docs')
	testImplementation("org.springframework.restdocs:spring-restdocs-mockmvc")
	testImplementation("io.rest-assured:rest-assured") // (optional if using RestAssuredMockMvc)
	testImplementation("io.rest-assured:spring-mock-mvc") // (optional)
}
// ìŠ¤ë‹ˆí«ìœ¼ë¡œ ì˜ì¡´ì„± ê¼¬ì„
test {
	outputs.dir snippetsDir
	useJUnitPlatform()
}

asciidoctor {
	// sourceDir, outputDir ë“± ê¸°ì¡´ ì„¤ì • ìœ ì§€
	sourceDir = file('src/docs/asciidoc')
	outputDir = file("$buildDir/docs/asciidoc")

	// snippetsDirê°€ ìˆì„ ë•Œë§Œ inputs.dir ë“±ë¡
	if (snippetsDir.exists()) {
		inputs.dir snippetsDir
		attributes 'snippets': snippetsDir.absolutePath
	} else {
		// ë””ë ‰í„°ë¦¬ê°€ ì—†ìœ¼ë©´ attributes ì„¤ì • ì œê±° ë˜ëŠ” ê¸°ë³¸ê°’ ì‚¬ìš© ê°€ëŠ¥
		attributes 'snippets': ''
	}

	dependsOn test
	baseDirFollowsSourceDir()
	// ë¹Œë“œ ë¬¸ì œ í•´ê²°
	attributes 'safe': 'unsafe'

//	sourceDir = file('src/docs/asciidoc') // ğŸ‘ˆ index.adoc ìœ„ì¹˜ ì§€ì •
//	outputDir = file("$buildDir/docs/asciidoc")
//	inputs.dir snippetsDir
//	dependsOn test
//
//	attributes 'snippets': snippetsDir.absolutePath
//	baseDirFollowsSourceDir()
}
gradle.startParameter.warningMode = WarningMode.None


//tasks.register('copyAsciidoctor', Copy) {
//	dependsOn asciidoctor
//	from layout.buildDirectory.dir('docs/asciidoc')
//	into layout.projectDirectory.dir('src/main/resources/static/docs')
//}

//build {
//	dependsOn 'copyAsciidoctor'
//}

bootJar {
	enabled = true
	dependsOn asciidoctor
	from('build/docs/asciidoc') {
		into 'static/docs'
	}
}

jar {
	enabled = false
}